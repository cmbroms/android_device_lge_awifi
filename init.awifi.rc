# Copyright (c) 2009-2013, The Linux Foundation. All rights reserved.
#
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions are met:
#     * Redistributions of source code must retain the above copyright
#       notice, this list of conditions and the following disclaimer.
#     * Redistributions in binary form must reproduce the above copyright
#       notice, this list of conditions and the following disclaimer in the
#       documentation and/or other materials provided with the distribution.
#     * Neither the name of Code Aurora nor
#       the names of its contributors may be used to endorse or promote
#       products derived from this software without specific prior written
#       permission.
#
# THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
# AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
# IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
# NON-INFRINGEMENT ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR
# CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
# EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
# PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;
# OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
# WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
# OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
# ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#

import init.awifi.usb.rc
import init.target.rc
import init.lge.log.rc
import init.lge.rc

on init
    # Set permissions for persist partition
    mkdir /persist 0771 system system
    # See storage config details at http://source.android.com/tech/storage/
    mkdir /mnt/shell/emulated 0700 shell shell
    mkdir /storage 0550 system sdcard_r
    mkdir /storage/emulated 0555 root root
    mkdir /storage/emulated/legacy 0555 root root
    mkdir /storage/external_SD 0000 system system

#[AUDIO_BSP][L05E] gooyeon.jung@lge.com 2013-02-21 Immersion vib. driver porting [START]
# Set a path to TMP folder (RW accessible)
    export VIBE_PIPE_PATH /dev/pipes
    mkdir /dev/pipes 0771 shell shell
#[AUDIO_BSP][L05E] gooyeon.jung@lge.com 2013-02-21 Immersion vib. driver porting [END]

    export EXTERNAL_STORAGE /storage/emulated/legacy
    export EXTERNAL_ADD_STORAGE /storage/external_SD
    export EMULATED_STORAGE_SOURCE /mnt/shell/emulated
    export EMULATED_STORAGE_TARGET /storage/emulated

    # Support legacy paths
	#2013.03.13 add symlink for Docomo PlayReady DRM[START] 
	symlink /storage/emulated/legacy /storage/emulated/0
	#2013.03.13 add symlink for Docomo PlayReady DRM[END] 
    symlink /storage/emulated/legacy /sdcard
    symlink /storage/emulated/legacy /mnt/sdcard
    symlink /storage/emulated/legacy /storage/sdcard0

    # LGE_CHANGE For USB Storage (USB OTG)
     export EXTERNAL_ADD_USB_STORAGE /storage/USBstorage
     export EXTERNAL_ADD_USB_STORAGE2 /storage/USBstorage2
     export EXTERNAL_ADD_USB_STORAGE3 /storage/USBstorage3
     export EXTERNAL_ADD_USB_STORAGE4 /storage/USBstorage4
     export EXTERNAL_ADD_USB_STORAGE5 /storage/USBstorage5
     export EXTERNAL_ADD_USB_STORAGE6 /storage/USBstorage6

     mkdir /storage/USBstorage 0000 system system
     mkdir /storage/USBstorage2 0000 system system
     mkdir /storage/USBstorage3 0000 system system
     mkdir /storage/USBstorage4 0000 system system
     mkdir /storage/USBstorage5 0000 system system
     mkdir /storage/USBstorage6 0000 system system

on early-boot
    # set RLIMIT_MEMLOCK to 64MB
    setrlimit 8 67108864 67108864
    exec /system/bin/sh /init.qcom.early_boot.sh ${ro.board.platform}
    exec /system/bin/sh /init.qcom.syspart_fixup.sh ${ro.board.platform} ${ro.serialno}

    # disable lmk_fast_run
    write /sys/module/lowmemorykiller/parameters/lmk_fast_run 0

on boot
    chown system system /sys/devices/platform/lg_diag_cmd/diag_enable
    chmod 0660 /sys/devices/platform/lg_diag_cmd/diag_enable
#2012-03-06 seongmook.yim(seongmook.yim@lge.com) [P6/MDMBSP] ADD LGODL [START]
#    chmod 0777 /system/bin/lg_dm_dev_router
#2012-03-06 seongmook.yim(seongmook.yim@lge.com) [P6/MDMBSP] ADD LGODL [END]

#LGE_CHANGE_S 20130821 sw84.lee [AWIFI][Touch] enable knock_on feature
    chown system system /sys/devices/i2c-3/3-004b/knock_on
    chmod 660 /sys/devices/i2c-3/3-004b/knock_on
#LGE_CHANGE_E 20130821 sw84.lee [AWIFI][Touch] enable knock_on feature
#LGE_CHANGE_S 20130830 goensoo.kim [AWIFI][Touch] enable smart_cover feature
    chown system system /sys/devices/i2c-3/3-004b/smart_cover
    chmod 660 /sys/devices/i2c-3/3-004b/smart_cover
#LGE_CHANGE_E 20130830 goensoo.kim [AWIFI][Touch] enable smart_cover feature

# LG_BTUI, 20120215, Permission for Bluetooth - [S]
    chown bluetooth bluetooth /sys/module/bluetooth_power/parameters/power
    chown bluetooth bluetooth /sys/class/rfkill/rfkill0/type
    chown bluetooth bluetooth /sys/class/rfkill/rfkill0/state
    chown bluetooth bluetooth /proc/bluetooth/sleep/proto
    chown bluetooth bluetooth /proc/bluetooth/sleep/btwake        
    chown system system /sys/module/sco/parameters/disable_esco
    chown bluetooth bluetooth /sys/module/hci_smd/parameters/hcismd_set
    chmod 0660 /sys/module/bluetooth_power/parameters/power
    chmod 0660 /sys/module/hci_smd/parameters/hcismd_set
    chmod 0660 /sys/class/rfkill/rfkill0/state
    chmod 0660 /proc/bluetooth/sleep/proto
    chmod 0660 /proc/bluetooth/sleep/btwake 
    chown bluetooth bluetooth /dev/ttyHS0
    chmod 0660 /dev/ttyHS0
    chown bluetooth bluetooth /sys/devices/platform/msm_serial_hs.0/clock
    chmod 0660 /sys/devices/platform/msm_serial_hs.0/clock
	chmod 0600 /dev/btlock
	chown bluetooth bluetooth /dev/btlock    
# LGE_UPDATE_S 20130511 keunhui.park setup for IRRC
	chown system audio /dev/msm_IRRC_pcm_dec
	chmod 0660 /dev/msm_IRRC_pcm_dec
# LGE_UPDATE_E 20130511 keunhui.park setup for IRRC


#    chmod 0660 /dev/ttyHS2
#    chown bluetooth bluetooth /dev/ttyHS2
# LG_BTUI, 20120215, Permission for Bluetooth - [E]

    #Create QMUX deamon socket area
    mkdir /dev/socket/qmux_radio 0770 radio radio
    chmod 2770 /dev/socket/qmux_radio
    mkdir /dev/socket/qmux_audio 0770 media audio
    chmod 2770 /dev/socket/qmux_audio
    mkdir /dev/socket/qmux_bluetooth 0770 bluetooth bluetooth
    chmod 2770 /dev/socket/qmux_bluetooth
    mkdir /dev/socket/qmux_gps 0770 gps gps
    chmod 2770 /dev/socket/qmux_gps

    setprop wifi.interface wlan0
    setprop ro.tether.denied true

    setprop ro.telephony.call_ring.multiple false

    #Set SUID bit for usbhub
    chmod 4755 /system/bin/usbhub
    chmod 755 /system/bin/usbhub_init

    #Remove SUID bit for iproute2 ip tool
    chmod 0755 /system/bin/ip

#LGE_CHANGE_S 20130605 keunhui.park [AWIFI][Vibrator] enable vibrator volume
	chown system system /sys/class/timed_output/vibrator/amp
#LGE_CHANGE_E 20130605 keunhui.park [AWIFI][Vibrator] enable vibrator volume
#LGE_CHANGE_S 20130621 keunhui.park [AWIFI][Audio] fix user of speaker power_on
	chown system system /sys/devices/i2c-0/0-0058/power_on
	chown system system /sys/devices/i2c-7/7-0058/power_on
#LGE_CHANGE_E 20130621 keunhui.park [AWIFI][Audio] fix user of speaker power_on

    chmod 0444 /sys/devices/platform/msm_hsusb/gadget/usb_state

    # Change permissions for fps_level nodes
    chown system graphics /sys/class/graphics/fb0/msm_fb_fps_level
    chown system graphics /sys/class/graphics/fb1/msm_fb_fps_level
    chown system graphics /sys/class/graphics/fb2/msm_fb_fps_level
    chmod 644 /sys/class/graphics/fb0/msm_fb_fps_level
    chmod 400 /sys/class/graphics/fb1/msm_fb_fps_level
    chmod 400 /sys/class/graphics/fb2/msm_fb_fps_level

    # Change owner and group for media server and surface flinger
    chown system system /sys/devices/virtual/graphics/fb1/format_3d

    #For bridgemgr daemon to inform the USB driver of the correct transport
    chown radio radio /sys/class/android_usb/f_rmnet_smd_sdio/transport

    #To allow interfaces to get v6 address when tethering is enabled
    write /proc/sys/net/ipv6/conf/rmnet0/accept_ra 2
    write /proc/sys/net/ipv6/conf/rmnet1/accept_ra 2
    write /proc/sys/net/ipv6/conf/rmnet2/accept_ra 2
    write /proc/sys/net/ipv6/conf/rmnet3/accept_ra 2
    write /proc/sys/net/ipv6/conf/rmnet4/accept_ra 2
    write /proc/sys/net/ipv6/conf/rmnet5/accept_ra 2
    write /proc/sys/net/ipv6/conf/rmnet6/accept_ra 2
    write /proc/sys/net/ipv6/conf/rmnet7/accept_ra 2
    write /proc/sys/net/ipv6/conf/rmnet_sdio0/accept_ra 2
    write /proc/sys/net/ipv6/conf/rmnet_sdio1/accept_ra 2
    write /proc/sys/net/ipv6/conf/rmnet_sdio2/accept_ra 2
    write /proc/sys/net/ipv6/conf/rmnet_sdio3/accept_ra 2
    write /proc/sys/net/ipv6/conf/rmnet_sdio4/accept_ra 2
    write /proc/sys/net/ipv6/conf/rmnet_sdio5/accept_ra 2
    write /proc/sys/net/ipv6/conf/rmnet_sdio6/accept_ra 2
    write /proc/sys/net/ipv6/conf/rmnet_sdio7/accept_ra 2
    write /proc/sys/net/ipv6/conf/rmnet_usb0/accept_ra 2
    write /proc/sys/net/ipv6/conf/rmnet_usb1/accept_ra 2
    write /proc/sys/net/ipv6/conf/rmnet_usb2/accept_ra 2
    write /proc/sys/net/ipv6/conf/rmnet_usb3/accept_ra 2

    # To prevent out of order acknowledgements from making
    # connection tracking to treat them as not belonging to
    # the connection they belong to.
    # Otherwise, a weird issue happens in which some long
    # connections on high-throughput links get dropped when
    # an ack packet comes out of order
    write /proc/sys/net/netfilter/nf_conntrack_tcp_be_liberal 1

#LGE_CHANGE_S, minjeon.kim@lge.com 2012-06-29 for performance
# Define TCP buffer sizes for various networks
#   ReadMin, ReadInitial, ReadMax, WriteMin, WriteInitial, WriteMax,
    setprop net.tcp.buffersize.default 8096,87380,110208,4096,16384,110208
    setprop net.tcp.buffersize.lte     8096,140625,3461120,4096,140625,3461120
    setprop net.tcp.buffersize.umts    8096,140625,3461120,4096,140625,3461120
    setprop net.tcp.buffersize.hspa    8096,140625,3461120,4096,140625,3461120
    setprop net.tcp.buffersize.hsupa   8096,140625,3461120,4096,140625,3461120
    setprop net.tcp.buffersize.hsdpa   8096,140625,3461120,4096,140625,3461120
    setprop net.tcp.buffersize.hspap   8096,140625,3461120,4096,140625,3461120
    setprop net.tcp.buffersize.edge    8096,87380,110208,4096,16384,35040
    setprop net.tcp.buffersize.gprs    8096,87380,110208,4096,8760,11680
# Assign TCP buffer thresholds to be ceiling value of technology maximums
# Increased technology maximums should be reflected here.
    write /proc/sys/net/core/rmem_max  3461120
    write /proc/sys/net/core/wmem_max  3461120
#LGE_CHANGE_E, minjeon.kim@lge.com 2012-06-29 for performance

#LGE_CHANGE_S, 20130305, jihee.moon@lge.com, Set the status of backlight brightness when boot
    setprop ro.lge.lcd_default_brightness 168
    setprop ro.lge.lcd_auto_brightness_mode false
#LGE_CHANGE_E, 20130305, jihee.moon@lge.com, Set the status of backlight brightness when boot

# LGE_CHANGE_S, 20120203, chaeuk.lee@lge.com, permission for IrDA tty driver
    chmod 664 /dev/ttyHSL3
    chown system system /dev/ttyHSL3
# LGE_CHANGE_E, 20120203, chaeuk.lee@lge.com

# LGE_CHANGE_S, 20120402, chaeuk.lee@lge.com, permission for IrDA factory procfs
    chown system system /proc/lge_irda_factory
# LGE_CHANGE_E, 20120402, chaeuk.lee@lge.com

# LGE_CHANGE_S, 20130108, seokjeong.hong@lge.com, AAT OTG Test
    chown system system /sys/class/android_usb/android0/otg
# LGE_CHANGE_E, 20130108, seokjeong.hong@lge.com, AAT OTG Test

# NFC Feature [start]
   symlink /dev/ttyHSL2 /dev/snfc_uart
   #symlink /dev/i2c-0 /dev/snfc_i2c
# NFC Feature [end]

# enable exfat feature
   insmod /system/lib/modules/texfat.ko


#[AUDIO_BSP][L05E] gooyeon.jung@lge.com 2013-02-21 Immersion vib. driver porting [START]
# TouchSense Player Service
service immvibed /system/bin/immvibed
    class main
    user shell
    group shell
    oneshot
#[AUDIO_BSP][L05E] gooyeon.jung@lge.com 2013-02-21 Immersion vib. driver porting [END]

on property:vold.post_fs_data_done=1
    start postinstaller
# LGE_CHANGE_E, [LGE_MODEL][CAPP_POSTINSTALL_MODIFIED], haksu.kim@lge.com, 2012-04-09

# LGE_CHANGE_S, 20130208, jinmo.koo@lge.com, enabling remotelock as dev-admin
service init_devadmin /system/bin/sh /system/vendor/bin/init_devadmin.sh
    class main
    user system
    group system
    oneshot
# LGE_CHANGE_E, 20130208, jinmo.koo@lge.com, enabling remotelock as dev-admin


on fs
# LGE_CHANGED_S [2013-02-14][jungjoo.nahm@lge.com] for widevine drm and lgdrm(future-use)
    chown system system /persist-lg
    chmod 0771 /persist-lg

    #LGDRM
    mkdir /persist-lg/lgdrm 0770 lgdrm lgdrm_acc

    #Widevine L1
    mkdir /persist-lg/widevine 0770 system system
# LGE_CHANGED_E [2013-02-14][jungjoo.nahm@lge.com] for widevine drm and lgdrm(future-use)

# LGE_CHANGED_S [2013-02-05][hyeyoung1024.kim@lge.com] for playreadydrm secureclock
# Create secure clock path
    mkdir /persist-lg/secclk 0700 system system
    chown system system /persist-lg/secclk
    chmod 0700 /persist-lg/secclk  
# LGE_CHANGED_E [2013-02-05][hyeyoung1024.kim@lge.com] for playreadydrm secureclock

# import cne init file
on post-fs
    # matia.kim@lge.com 2013.04.10 execute sreadahead daemon to reduce boot-time
    start sreadahead

    export LD_PRELOAD /system/lib/libNimsWrap.so
# LGE_CHANGE_S, 20120313, tei.kim@lge.com, dump last_kmsg to /data/dontpanic
   exec /system/bin/sh /system/etc/last_kmsg_backup.sh
# LGE_CHANGE_E, 20120313, tei.kim@lge.com, dump last_kmsg to /data/dontpanic

# msm specific files that need to be created on /data
on post-fs-data
    # we will remap this as /mnt/sdcard with the sdcard fuse tool
    mkdir /data/media 0770 media_rw media_rw
    chown media_rw media_rw /data/media

# LG_BTUI, 20120215, Permission for Bluetooth - [S]
#    mkdir /data/misc/bluetooth 0770 bluetooth bluetooth
	mkdir /data/misc/bluetooth 0770 bluetooth bluetooth
    # Feature chip vendor : brcm, qct
    setprop bluetooth.chip.vendor qct
    setprop persist.service.bt.support.map false
# LG_BTUI, 20120215, Permission for Bluetooth - [E]	    

    # Create the directories used by the Wireless subsystem
    mkdir /data/misc/wifi 0771 wifi wifi
    mkdir /data/misc/wifi/sockets 0770 wifi wifi
    mkdir /data/misc/wifi/wpa_supplicant 0770 wifi wifi
    mkdir /data/misc/dhcp 0770 dhcp dhcp
    chown dhcp dhcp /data/misc/dhcp

    # Create the directory used by CnE subsystem
    mkdir /data/connectivity 0771 system system
    chown system system /data/connectivity

    # Create directory used by audio subsystem
    mkdir /data/misc/audio 0770 audio audio

    # Mounting of persist is moved to 'on emmc-fs' and 'on fs' sections
    # We chown/chmod /persist again so because mount is run as root + defaults
    chown system system /persist
    chmod 0771 /persist
    chmod 0664 /sys/devices/platform/msm_sdcc.1/polling
    chmod 0664 /sys/devices/platform/msm_sdcc.2/polling
    chmod 0664 /sys/devices/platform/msm_sdcc.3/polling
    chmod 0664 /sys/devices/platform/msm_sdcc.4/polling

    # Chown polling nodes as needed from UI running on system server
    chown system system /sys/devices/platform/msm_sdcc.1/polling
    chown system system /sys/devices/platform/msm_sdcc.2/polling
    chown system system /sys/devices/platform/msm_sdcc.3/polling
    chown system system /sys/devices/platform/msm_sdcc.4/polling
#2012-03-06 seongmook.yim(seongmook.yim@lge.com) [P6/MDMBSP] ADD LGODL [START]
#    chmod 0777 /dev/lge_dm_dev_tty0
#    chown system system /dev/lge_dm_dev_tty0
#2012-03-06 seongmook.yim(seongmook.yim@lge.com) [P6/MDMBSP] ADD LGODL [END]

# LGE_CHANGE_S, 20111226, jin.park@lge.com, Mobile DM Router
#    chmod 0660 /dev/lge_dm_tty0
#    chown system system /dev/lge_dm_tty0
# LGE_CHANGE_E, 20111226, jin.park@lge.com

    #Create the symlink to qcn wpa_supplicant folder for ar6000 wpa_supplicant
    mkdir /data/system 0775 system system
    #symlink /data/misc/wifi/wpa_supplicant /data/system/wpa_supplicant

#LGE_CHANGE_GPS, [S] taejin.lee@lge.com 2012-12-07, To disable wiper service
    #Create directories for wiper services
#    mkdir /data/wpstiles/ 0755 shell
#    mkdir /data/wiper 0755 gps qcom_oncrpc
#LGE_CHANGE_GPS, [E] taejin.lee@lge.com 2012-12-07, To disable wiper service

    #Create directories for gpsone_daemon services
#   mkdir /data/misc/gpsone_d 0770 system gps

    #Create directories for QuIPS
#   mkdir /data/misc/quipc 0770 gps system

    #Create directories for Location services
#   mkdir /data/misc/location 0770 gps gps
#   mkdir /data/misc/location/mq 0770 gps gps
#   mkdir /data/misc/location/xtwifi 0770 gps gps

    #Create directory from IMS services
    mkdir /data/shared 0755
    chown system system /data/shared

    #Create directory for FOTA
    mkdir /data/fota 0771
    chown system system /data/fota

    #Create directory for hostapd
    mkdir /data/hostapd 0770 system wifi

    # Create /data/time folder for time-services
    mkdir /data/time/ 0700 system system

    mkdir /data/audio/ 0770 media audio

# sungwook.park@lge.com 2013.04.23 change qcks, ks, efsks into system process
    chown system /dev/block/platform/msm_sdcc.1/by-name

    setprop vold.post_fs_data_done 1

    setprop ro.ssbd.session /dev/block/platform/msm_sdcc.1/by-name/eksst
    setprop ro.ssbd.offset 0

	#LGE_CHANGE_S 20130408 HiddenMenu, yunsun.choi@lge.com
	exec /system/bin/smpl_count
	#LGE_CHANGE_E 20130408 HiddenMenu, yunsun.choi@lge.com

# bonkang.koo@lge.com 2012.10.23 set default sdcard fs type
    setprop vold.sdcard_fs_type none

# Export GPIO56 for fusion targets to enable/disable hub
service usbhub_init /system/bin/usbhub_init
   class late_start
   user root
   disabled
   oneshot

on property:init.svc.surfaceflinger=stopped
    stop ppd
    stop hdmid

on property:ro.board.platform=msm7630_fusion
    start usbhub_init

on property:init.svc.wpa_supplicant=stopped
    stop dhcpcd

on property:bluetooth.isEnabled=true
    start btwlancoex
    write /sys/class/bluetooth/hci0/idle_timeout 7000

service qcom-c_core-sh /system/bin/sh /init.qcom.class_core.sh
    class core
    user root
    oneshot

service qcom-c_main-sh /system/bin/sh /init.qcom.class_main.sh
    class main
    user root
    oneshot

on property:vold.decrypt=trigger_restart_framework
    start qcom-c_main-sh
    start config_bluetooth

service cnd /system/bin/cnd
    class late_start
    socket cnd stream 660 root inet

service irsc_util /system/bin/logwrapper /system/bin/irsc_util "/etc/sec_config"
    class main
    user root
    oneshot

service rmt_storage /system/bin/rmt_storage
    class core
    user root
    disabled

on property:ro.boot.emmc=true
    start rmt_storage

service config_bluetooth /system/bin/sh /system/etc/init.qcom.bt.sh "onboot"
    class core
    user root
    oneshot

service dbus /system/bin/dbus-daemon --system --nofork
    class core
    socket dbus stream 660 bluetooth bluetooth
    user bluetooth
    group bluetooth net_bt_admin
    disabled

on property:ro.qc.bluetooth.stack=bluez
    start dbus

service bluetoothd /system/bin/logwrapper /system/bin/bluetoothd -n
    class main
    socket bluetooth stream 660 bluetooth bluetooth
    socket dbus_bluetooth stream 660 bluetooth bluetooth
    # init.rc does not yet support applying capabilities, so run as root and
    # let bluetoothd drop uid to bluetooth with the right linux capabilities
    group bluetooth net_bt_admin misc net_bt_stack
    disabled

service hciattach /system/bin/sh /system/etc/init.qcom.bt.sh
    class late_start
    user bluetooth
    group qcom_oncrpc bluetooth net_bt_admin  system
    disabled
    oneshot

on property:bluetooth.hciattach=true
    start hciattach

on property:bluetooth.hciattach=false
    setprop bluetooth.status off

service hciattach_ath3k /system/bin/sh /system/etc/init.ath3k.bt.sh
     class late_start
     user bluetooth
     group system bluetooth net_bt_admin misc
     disabled
     oneshot

service bt-dun /system/bin/dun-server /dev/smd7 /dev/rfcomm0
    class late_start
    user bluetooth
    group bluetooth net_bt_admin inet
    disabled
    oneshot

service bt-sap /system/bin/sapd 15
    user bluetooth
    group bluetooth net_bt_admin
    class late_start
    disabled
    oneshot

service bridgemgrd /system/bin/bridgemgrd
    class late_start
    user radio
    group radio qcom_diag
    disabled

service port-bridge /system/bin/port-bridge /dev/smd0 /dev/ttyGS0
    class late_start
    user system
    group system inet
    disabled

service qmiproxy /system/bin/qmiproxy
    class main
    user radio
    group radio qcom_diag
    disabled

# QMUX must be in multiple groups to support external process connections
service qmuxd /system/bin/qmuxd
    class main
    user radio
    group radio audio bluetooth gps qcom_diag
    disabled

service netmgrd /system/bin/netmgrd
    class main
    disabled

service sensors /system/bin/sensors.qcom
    class late_start
    user root
    group root
    disabled

on property:ro.use_data_netmgrd=false
    # netmgr not supported on specific target
    stop netmgrd

# Adjust socket buffer to enlarge TCP receive window for high bandwidth
# but only if ro.data.large_tcp_window_size property is set.
on property:ro.data.large_tcp_window_size=true
    write /proc/sys/net/ipv4/tcp_adv_win_scale  1

service btwlancoex /system/bin/sh /system/etc/init.qcom.coex.sh
    class late_start
    user bluetooth
    group bluetooth net_bt_admin inet net_admin net_raw
    disabled
    oneshot

# daeon.shon@lge.com disable 3LM encription because it used only in Docomo [START]
#on property:ro.build.type=eng
#    # 3LM settings
#    setprop ro.3lm.production 0
#    setprop ro.3lm.build.lg true
#    setprop ro.3LM.extended 1
#    setprop ro.camera.sound.forced 1
#    setprop ro.3LM.oem_manifest 3
#    setprop ro.3LM.address c2.z.3lm.com
#    setprop ro.3lm.build.lge true
#    # 3LM encryption
#    setprop ro.3lm.legacy_encryption 1
#
#on property:ro.build.type=userdebug
#    # 3LM settings
#    setprop ro.3lm.production 0
#    setprop ro.3LM.extended 1
#    setprop ro.camera.sound.forced 1
#    setprop ro.3LM.oem_manifest 3
#    setprop ro.3LM.address c2.z.3lm.com
#    # 3LM encryption
#    setprop ro.3lm.legacy_encryption 1
#
#on property:ro.build.type=user
#    # 3LM settings
#    setprop ro.3lm.production 1
#    setprop ro.3LM.extended 1
#    setprop ro.camera.sound.forced 1
#    setprop ro.3LM.oem_manifest 3
#    setprop ro.3LM.address c2.z.3lm.com
#    # 3LM encryption
#    setprop ro.3lm.legacy_encryption 1
# daeon.shon@lge.com disable 3LM encription because it used only in Docomo [END]

service p2p_supplicant /system/bin/logwrapper /system/bin/wpa_supplicant \
    -ip2p0  -Dnl80211 -c/data/misc/wifi/p2p_supplicant.conf -N \
    -iwlan0 -Dnl80211 -c/data/misc/wifi/wpa_supplicant.conf -dd \
    -e/data/misc/wifi/entropy.bin -puse_p2p_group_interface=1use_multi_chan_concurrent=1
    #   we will start as root and wpa_supplicant will switch to user wifi
    #   after setting up the capabilities required for WEXT
    #   user wifi
    #   group wifi inet keystore
    class main
    socket wpa_wlan0 dgram 660 wifi wifi
    disabled
    oneshot

service wpa_supplicant /system/bin/logwrapper /system/bin/wpa_supplicant \
    -iwlan0 -Dnl80211 -c/data/misc/wifi/wpa_supplicant.conf -d \
    -e/data/misc/wifi/entropy.bin
    #   we will start as root and wpa_supplicant will switch to user wifi
    #   after setting up the capabilities required for WEXT
    #   user wifi
    #   group wifi inet keystore
    class main
    socket wpa_wlan0 dgram 660 wifi wifi
    disabled
    oneshot

# if G option added, the gateway do not update in the specific status. from jaeshick.shin@lge.com
service dhcpcd_wlan0 /system/bin/dhcpcd -ABKL
    class late_start
    disabled
    oneshot

# Original As below
#service dhcpcd_wlan0 /system/bin/dhcpcd -ABKLG
#    class late_start
#    disabled
#    oneshot

service dhcpcd_p2p /system/bin/dhcpcd -ABKLG
    class late_start
    disabled
    oneshot

service iprenew_wlan0 /system/bin/dhcpcd -n
    class late_start
    disabled
    oneshot

service iprenew_p2p /system/bin/dhcpcd -n
    class late_start
    disabled
    oneshot

service dhcpcd_bnep0 /system/bin/dhcpcd -BKLG
    disabled
    oneshot

service dhcpcd_bnep1 /system/bin/dhcpcd -BKLG
    disabled
    oneshot

service dhcpcd_bnep2 /system/bin/dhcpcd -BKLG
    disabled
    oneshot

service dhcpcd_bnep3 /system/bin/dhcpcd -BKLG
    disabled
    oneshot

service dhcpcd_bnep4 /system/bin/dhcpcd -BKLG
    disabled
    oneshot

#LGE_CHANGE_GPS, [S] taejin.lee@lge.com 2012-12-07, To disable wiper service
#service wiperiface /system/bin/wiperiface
#    class late_start
#    user gps
#    group gps qcom_oncrpc net_raw
#    oneshot
#LGE_CHANGE_GPS, [E] taejin.lee@lge.com 2012-12-07, To disable wiper service
#LGE_CHANGE_GPS, [S]sunim2.lee@lge.com 2013-01-29, To disable gpsone_daemon feature except sprint and VZW. 
#service gpsone_daemon /system/bin/gpsone_daemon
#    class late_start
#    user gps
#    group gps qcom_oncrpc inet net_raw
#    disabled
#LGE_CHANGE_GPS, [E]sunim2.lee@lge.com 2013-01-29, To disable gpsone_daemon feature except sprint and VZW. 
#LGE_CHANGE_GPS, [S] zenith.lee@lge.com 2012-10-08, To disable QuiPS feature
#service quipc_igsn /system/bin/quipc_igsn
#    class late_start
#    user gps
#    group inet gps
#    disabled

#service quipc_main /system/bin/quipc_main
#    class late_start
#    user gps
#    group gps net_admin wifi inet
#    disabled
#LGE_CHANGE_GPS, [E] zenith.lee@lge.com 2012-10-08, To disable QuiPS feature

#LGE_CHANGE_GPS, [S] zenith.lee@lge.com 2012-10-18, To disable XTWifi feature 
#service location_mq /system/bin/location-mq
#    class late_start
#    user gps
#    group gps
#    disabled
 
#service xtwifi_inet /system/bin/xtwifi-inet-agent
#    class late_start
#    user gps
#    group inet gps
#    disabled
 
#service xtwifi_client /system/bin/xtwifi-client
#    class late_start
#    user gps
#    group net_admin wifi inet gps
#    disabled
#LGE_CHANGE_GPS, [E] zenith.lee@lge.com 2012-10-18, To disable XTWifi feature
service lowi-server /system/bin/lowi-server
    class late_start
    user gps
    group gps net_admin wifi inet
    disabled

service fm_dl /system/bin/sh /system/etc/init.qcom.fm.sh
    class late_start
    user root
    group system qcom_oncrpc
    disabled
    oneshot

on property:crypto.driver.load=1
     insmod /system/lib/modules/qce.ko
     insmod /system/lib/modules/qcedev.ko

on property:crypto.driver.load=0
     exec /system/bin/rmmod qcedev.ko
     exec /system/bin/rmmod qce.ko

service drmdiag /system/bin/drmdiagapp
    class late_start
     user root
     disabled
     oneshot

on property:drmdiag.load=1
    start drmdiag

on property:drmdiag.load=0
    stop drmdiag

service qcom-sh /system/bin/sh /init.qcom.sh
    class late_start
    user root
    oneshot

service qcom-post-boot /system/bin/sh /system/etc/init.qcom.post_boot.sh
    class late_start
    user root
    disabled
    oneshot

service wifi-sdio-on /system/bin/sh /system/etc/init.qcom.sdio.sh
    class late_start
    group wifi inet
    disabled
    oneshot

service wifi-crda /system/bin/sh /system/etc/init.crda.sh
   class late_start
   user root
   disabled
   oneshot

# kyle00.choi, 20130515,  to stop bootchart2 automatically in LG-V500 model [START]
service bootchartd-stop /sbin/bootchartd stop
   class late_start
   user root
   disabled
   oneshot

on property:sys.bootchart.timeout=1
    start bootchartd-stop
    setprop sys.bootchart.timeout 0
# kyle00.choi, 20130515,  to stop bootchart2 automatically in LG-V500 model [END]

on property:sys.boot_completed=1
    start qcom-post-boot

# kyle00.choi, 20130630, remove ATFWD-daemon [START]
#service atfwd /system/bin/ATFWD-daemon
#    class late_start
#    user system
#    group system radio
#    onrestart /system/bin/log -t RIL-ATFWD -p w "ATFWD daemon restarted"
# kyle00.choi, 20130630, remove ATFWD-daemon [END]

service hdmid /system/bin/hdmid
    class late_start
    socket hdmid stream 0660 root system graphics
    disabled

service ppd /system/bin/mm-pp-daemon
    class late_start
    user system
    socket pps stream 0660 system system graphics
    group system graphics

service hostapd /system/bin/hostapd -dddd /data/hostapd/hostapd.conf
    class late_start
    user root
    group root
    oneshot
    disabled

service ds_fmc_appd /system/bin/ds_fmc_appd -p "rmnet0" -D
    class late_start
    group radio wifi inet
    disabled
    oneshot

on property:persist.data.ds_fmc_app.mode=1
    start ds_fmc_appd

service ims_regmanager /system/bin/exe-ims-regmanagerprocessnative
    class late_start
    group qcom_oncrpc net_bt_admin inet radio wifi
    disabled

on property:persist.ims.regmanager.mode=1
    start ims_regmanager

on property:ro.data.large_tcp_window_size=true
    # Adjust socket buffer to enlarge TCP receive window for high bandwidth (e.g. DO-RevB)
    write /proc/sys/net/ipv4/tcp_adv_win_scale  1

service battery_monitor /system/bin/battery_monitor
    user system
    group system
    disabled

service ril-daemon1 /system/bin/rild -c 1
    class main
    socket rild1 stream 660 root radio
    socket rild-debug1 stream 660 radio system
    user root
    disabled
    group radio cache inet misc audio sdcard_r sdcard_rw qcom_oncrpc diag qcom_diag log

service profiler_daemon /system/bin/profiler_daemon
    class late_start
    user root
    group root
    disabled

service sdcard /system/bin/sdcard /data/media /mnt/shell/emulated 1023 1023
    class main
#    disabled

on property:ro.fuse_sdcard=true
    start sdcard

# Binding fuse mount point to /storage/emulated/legacy
on property:init.svc.sdcard=running
    wait /mnt/shell/emulated/0
    mount none /mnt/shell/emulated/0 /storage/emulated/legacy bind

# This will make sure that sdcard service starts as late_start.
on nonencrypted
    setprop ro.fuse_sdcard ${persist.fuse_sdcard}

on property:vold.decrypt=trigger_restart_framework
    setprop ro.fuse_sdcard ${persist.fuse_sdcard}

service hcidump /system/bin/sh /system/etc/hcidump.sh
    user bluetooth
    group bluetooth system net_bt_admin net_admin
    disabled
    oneshot

service hciattach_dut /system/bin/sh /system/etc/init.lge_dut.bt.sh
   user bluetooth
   group qcom_oncrpc bluetooth net_bt_admin
   disabled
   oneshot
    
service charger /charger
    class charger

# LGE_CHANGE_S, 20120903, jin.park@lge.com, Mobile DM Router
#service lg_dm_router /system/bin/lg_dm_router
#    class late_start
#    user system
#    group system
#    disabled
#    socket Full.DM.port stream 660 system system

#on property:persist.service.dm_app.enable=true
#    start lg_dm_router
#on property:persist.service.dm_app.enable=false
#    stop lg_dm_router
# LGE_CHANGE_E, 20120903, jin.park@lge.com, Mobile DM Router


on property:persist.sys.cabc_off=true
    write /sys/devices/platform/mipi_lgit.1793/cabc_off 1

on property:persist.sys.cabc_off=false
    write /sys/devices/platform/mipi_lgit.1793/cabc_off 0


service ssr_diag /system/bin/ssr_diag
    class late_start
    user system
    group system

# LGE_CHANGE_S, 20120203, chaeuk.lee@lge.com, daemon for IrDA obex
service objectexchanged /system/bin/objectexchanged
    user system
    group radio system
    class core
# LGE_CHANGE_E, 20120203, chaeuk.lee@lge.com

# 2013-02-04, SangYeol-Byeon(sangyeol.byeon@lge.com), VirusScanDeamon [Start]
service mfescand /system/bin/mfescand
    class main
    socket mfescand stream 600 system system
# 2013-02-04, SangYeol-Byeon(sangyeol.byeon@lge.com), VirusScanDeamon [End]

# LGE_CHANGE_S, 20120203, chaeuk.lee@lge.com, property for IrDA obex
on property:sys.irda.config=enable
    exec /system/bin/ifconfig irda0 up
    write /proc/sys/net/irda/devname "LG-V500/n"
    write /proc/sys/net/irda/max_tx_data_size 2048
    write /proc/sys/net/irda/discovery_timeout 1

on property:sys.irda.config=disable
    exec /system/bin/ifconfig irda0 down
    write /proc/sys/net/irda/devname "Linux"
    write /proc/sys/net/irda/max_tx_data_size 2042
    write /proc/sys/net/irda/discovery_timeout 3

on property:sys.irda.discovery=start
    write /proc/sys/net/irda/discovery 1

on property:sys.irda.discovery=stop
    write /proc/sys/net/irda/discovery 0
# LGE_CHANGE_E, 20120203, chaeuk.lee@lge.com
	
#2012-03-06 seongmook.yim(seongmook.yim@lge.com) [P6/MDMBSP] ADD LGODL [START]
#service lg_dm_dev_router /system/bin/lg_dm_dev_router
#    class late_start
#    user system 
#    group system sdcard_r sdcard_rw 
#    disabled
#    oneshot

#on property:persist.service.lge.odl_on=true
#on property:service.lge.odl_on=true
#     start lg_dm_dev_router

#on property:persist.service.lge.odl_on=false
#on property:service.lge.odl_on=false
#    stop lg_dm_dev_router
#2012-03-06 seongmook.yim(seongmook.yim@lge.com) [P6/MDMBSP] ADD LGODL [END]

#RCT
service rctd /system/bin/rctd
  class late_start
  user root
  group root

# Limit to SoC reset (1) and independent SSR (3)
on property:persist.sys.ssr.restart_level=1
    write /sys/module/subsystem_restart/parameters/restart_level 1
on property:persist.sys.ssr.restart_level=3
    write /sys/module/subsystem_restart/parameters/restart_level 3

# matia.kim@lge.com 2013.04.10 execute sreadahead daemon to reduce boot-time
service sreadahead /sbin/treadahead
    oneshot
    disabled
# matia.kim@lge.com 2013.04.03 make a diecision whether sreadahead would be performed or not.
service sreadahead-check /sbin/sreadahead_check
    class main
    user root
    group root
    oneshot

# disable ramdump function, enable RIVA restart
on property:ro.build.type=user
   write /sys/module/subsystem_restart/parameters/restart_level 3
   write /sys/module/subsystem_restart/parameters/enable_ramdumps 0
   write /sys/module/wcnss_ssr_8960/parameters/enable_riva_ssr 1

# LGE_CHANGE_S, 20120810 bonkang.koo@lge.com, factory reset magic code
on property:sys.factory=1
    exec /system/bin/dd if=/system/etc/factory_reset_magic of=/dev/block/platform/msm_sdcc.1/by-name/reserved bs=512 count=1
# LGE_CHANGE_E, 20120810 bonkang.koo@lge.com, factory reset magic code

#LGE_CHANGE_S HiddenMenu, Fake Battery Mode

on property:persist.service.fakebatt=1
    write /sys/devices/platform/msm_ssbi.0/pm8921-core/pm8921-charger/power_supply/battery/pseudo_batt "1 1 100 40 4100 80 1"

on property:persist.service.fakebatt=0
    write /sys/devices/platform/msm_ssbi.0/pm8921-core/pm8921-charger/power_supply/battery/pseudo_batt "0 1 100 40 4100 80 1"

#LGE_CHANGE_E HiddenMenu, Fake Battery Mode
#service diagd /system/bin/diagd 
#	class late_start
#	user root
#	group radio system
#	disabled
#	oneshot
#	socket lsock_diagd stream 666
#
#on property:wifi_ftm.diagd_start=1
#    start diagd
#
#on property:wifi_ftm.diagd_start=0
#    stop diagd

service ftm_ptt /system/bin/ftm_ptt -d
    class late_start
    user root
    group radio
    disabled
    oneshot

on property:hw.ftm_ptt_start=1
    start ftm_ptt

on property:hw.ftm_ptt_start=0
    stop ftm_ptt
#LGE_CHANGE_S 2012.04 lg-msp@lge.com MTS TEAM
	service mtsd /system/bin/mtsd
	class late_start
	oneshot
	socket mtsd.port stream 660 system system
#LGE_CHANGE_E 2012.04 lg-msp@lge.com MTS TEAM


# LGBACKUP [ig.kang@lge.com] SystemService Daemon
service bnrd /system/bin/bnrd
      class main
      socket bnrd stream 660 root system
      user root
      group system radio sdcard_rw
# LGBACKUP SystemService Daemon

service ssbd /system/bin/ssbd
    class main
    disabled

on property:ssbd.enable=1
    start ssbd

on property:ssbd.enable=0
    stop ssbd







service ufips /system/bin/ufips
    class core
    user system
    group system

# [LGE_VPN][iamjm.oh] Inside Secure VPN Kernel Module install [START]
on boot
   insmod /system/lib/modules/vpnclient.ko ssh_procfs_uid=1000 ssh_procfs_gid=1000

service vpnclientpm /system/bin/vpnclientpm -O /data/data/com.ipsec.vpnclient/vpnclientpm.txt -D*Pm*=99,*Netconfig*=99 -K*=99 -u 1000
# uid dropped to system when capabilities are set
  class main
  group system net_admin net_raw
  disabled

service secstarter /system/bin/secstarter
  class main
  user system
  group system net_admin net_raw
# [LGE_VPN][iamjm.oh] Inside Secure VPN Service & modules permission change [END]
